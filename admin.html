<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8"/>
<title>Admin - Snacks Store</title>
</head>
<body>

<h2>ููุญุฉ ุงูุชุญูู</h2>

<h3>ุฅุถุงูุฉ ููุชุฌ</h3>
<input id="pname" placeholder="ุงุณู ุงูููุชุฌ">
<input id="pprice" placeholder="ุงูุณุนุฑ">
<input id="pimg" placeholder="ุฑุงุจุท ุตูุฑุฉ ุงูููุชุฌ">
<button onclick="addProduct()">ุฅุถุงูุฉ</button>

<p>ูุฑูุน ุตูุฑุฉ: ุงุฑูุนูุง ุนูู postimages.org ูุฎุฏ ุงูุฑุงุจุท ุงููุจุงุดุฑ ูุญุทู ููุง</p>

<h3>ุงูููุชุฌุงุช</h3>
<div id="plist"></div>

<h3>ุงูุทูุจุงุช</h3>
<div id="orders"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBY0MBybVBW5GHpN1gatyrOqdYHkH726zw",
  authDomain: "snacks-store-35112.firebaseapp.com",
  databaseURL: "https://snacks-store-35112-default-rtdb.firebaseio.com",
  projectId: "snacks-store-35112",
  storageBucket: "snacks-store-35112.firebasestorage.app",
  messagingSenderId: "523521529745",
  appId: "1:523521529745:web:2fb1ec4fc48d99e11eec30"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.addProduct = ()=>{
 push(ref(db,"products"),{
   name:pname.value,
   price:pprice.value,
   img:pimg.value
 });
 alert("ุชูุช ุงูุฅุถุงูุฉ");
};

onValue(ref(db,"products"), snap=>{
 plist.innerHTML="";
 snap.forEach(c=>{
   plist.innerHTML+=\`\${c.val().name} <button onclick="delProd('\${c.key}')">ุญุฐู</button><br>\`;
 });
});

window.delProd = (id)=> remove(ref(db,"products/"+id));

onValue(ref(db,"orders"), snap=>{
 orders.innerHTML="";
 snap.forEach(c=>{
   let o=c.val();
   orders.innerHTML+=\`
   <div style="border:1px solid #000;margin:5px;padding:5px">
   ๐ค \${o.name}<br>
   ๐ \${o.phone}<br>
   ุงูุญุงูุฉ: \${o.status}<br>
   <a href="\${o.location}" target="_blank">ุงููููุน</a><br>
   <button onclick="confirmOrder('\${c.key}')">ุชุฃููุฏ</button>
   </div>\`;
 });
});

window.confirmOrder=(id)=> update(ref(db,"orders/"+id),{status:"ุชู ุงูุชุฃููุฏ"});
</script>
</body>
</html>
